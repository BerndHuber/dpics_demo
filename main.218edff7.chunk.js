(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{11:function(e,a,t){e.exports=t(21)},17:function(e,a,t){},19:function(e,a,t){e.exports=t.p+"static/media/logo.5d5d9eef.svg"},20:function(e,a,t){},21:function(e,a,t){"use strict";t.r(a);var l,n,s=t(0),c=t.n(s),i=t(4),r=t.n(i),o=(t(17),t(2)),d=t.n(o),m=t(5),p=t(6),u=t(7),v=t(9),h=t(8),b=t(1),E=t(10),g=(t(19),t(20),[0,0,0,0,0,0,0,0]),f=0;try{var N=new(0,window.webkitSpeechRecognition);N.continuous=!0,N.onresult=function(e){var a=e.resultIndex,t=e.results[a][0].transcript;";"+t;var n;n=t,l.classify([n]).then(function(e){for(var a=0,t=1,l=[],s=0;s<8;s++)e[s].results[0].probabilities[0]<t&&(a=s,t=e[s].results[0].probabilities[0]),console.log(e[s].results[0].probabilities[0]),l.push(e[s].results[0].probabilities[0]);console.log("--");var c=[0,5,2,3,6,4,1,7][a];return g[c]+=1,y("speech:"+n,l),w(),!0})},N.onstart=function(){console.log("Voice recognition is ON.")},N.onspeechend=function(){console.log("No activity."),N.stop(),1==f&&setTimeout(function(){N.start(),console.log("speech started")},500)},N.onerror=function(e){"no-speech"==e.error&&(console.log("Try again."),N.stop(),1==f&&setTimeout(function(){N.start(),console.log("speech started")},500))}}catch(x){console.log(x.message)}function w(){n.data.datasets[0].data=g,n.update()}function y(e,a){var t="https://script.google.com/macros/s/AKfycbwK3EEp-8NU7wLEXLrZesp7XcjUYh7H6zdgQj7vBfDpDlwa13gl/exec?";t+="timest="+(new Date).getTime(),t+="&sentence="+e,t+="&bd="+a[0],t+="&cmd="+a[1],t+="&lp="+a[2],t+="&nt="+a[3],t+="&neutral="+a[4],t+="&qu="+a[5],t+="&rf="+a[6],t+="&up="+a[7],console.log("uploading data"),fetch(t).then(function(e){return e.text()}).then(function(e){console.log("response: "),console.log(e)}).catch(function(e){console.log(e)})}var k=function(e){function a(e){var t;return Object(p.a)(this,a),(t=Object(v.a)(this,Object(h.a)(a).call(this,e))).uploadFlagToServer=function(e,a,t,l){return function(n){if(console.log("uploadFlagToServer"),1!=t||!l.state.flagged_sentences.includes(e)){var s=l.state.flagged_sentences;s.push(e),l.setState({flagged_sentences:s});var c="https://script.google.com/macros/s/AKfycbwK3EEp-8NU7wLEXLrZesp7XcjUYh7H6zdgQj7vBfDpDlwa13gl/exec?";c+="timest="+(new Date).getTime(),c+="&sentence="+e,c+="&bd="+a[0],c+="&cmd="+a[1],c+="&lp="+a[2],c+="&nt="+a[3],c+="&neutral="+a[4],c+="&qu="+a[5],c+="&rf="+a[6],c+="&up="+a[7],c+="&flagged="+t,console.log("uploading data"),fetch(c).then(function(e){return e.text()}).then(function(e){console.log("response: "),console.log(e)}).catch(function(e){console.log(e)})}}},t.handleEnglishClick=function(){return function(e){t.setState({lan:"en"})}},t.handleJapaneseClick=function(){return function(e){t.setState({lan:"ja"})}},t.classifyText=function(){return function(e){var a=Object(b.a)(t);console.log(document.getElementById("classify-new-text-input").value);var n=document.getElementById("classify-new-text-input").value;if("ja"==a.state.lan){var s="https://translate.googleapis.com/translate_a/single?client=gtx&sl=ja&tl=en&dt=t&q="+encodeURI(n),c=n;fetch(s).then(function(e){return e.json()}).then(function(e){n=e[0][0][0],l.classify([n]).then(function(e){console.log(e);for(var t=[],l=[],s=0,i=1,r=0;r<8;r++)e[r].results[0].probabilities[0]<i&&(s=r,i=e[r].results[0].probabilities[0]),console.log(e[r].results[0].probabilities[0]),e[r].results[0].probabilities[0]>.9?t.push(1):t.push(0),l.push(e[r].results[0].probabilities[0]);(t=[0,0,0,0,0,0,0,0])[s]=1,y("jap:"+c+";"+n,l),console.log(t);var o=a.state.sentences;return o.unshift({text:c,pred:t,proba:l}),a.setState({sentence:o}),!0})}).catch(function(e){console.log(e)})}else l.classify([n]).then(function(e){console.log(e);for(var t=[],l=[],s=0,c=1,i=0;i<8;i++)e[i].results[0].probabilities[0]<c&&(s=i,c=e[i].results[0].probabilities[0]),console.log(e[i].results[0].probabilities[0]),e[i].results[0].probabilities[0]>.9?t.push(1):t.push(0),l.push(e[i].results[0].probabilities[0]);(t=[0,0,0,0,0,0,0,0])[s]=1,y(n,l),console.log(t);var r=a.state.sentences;return r.unshift({text:n,pred:t,proba:l}),a.setState({sentence:r}),!0})}},t.state={participantid:Date.now(),sentences:[{text:"What are you doing?",pred:[0,0,0,0,0,1,0,0],proba:[1,1,1,1,1,0,1,1]}],flagged_sentences:[],lan:"en"},t}return Object(E.a)(a,e),Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=Object(m.a)(d.a.mark(function e(){var a,t,s;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=window.location.href,t=new URL(a),"ja"==t.searchParams.get("ln")&&this.setState({lan:"ja",sentences:[{text:"\u4f55\u3057\u3066\u308b\u306e\uff1f",pred:[0,0,0,0,0,1,0,0],proba:[1,1,1,1,1,0,1,1]}]}),.7,s=["unlabelled_praise","command","neutral_talk","labelled_praise","question","behavior_description","reflection","negative_talk"],window.toxicity.load(.7,s).then(function(e){l=e}),n=new window.Chart(document.getElementById("bar-chart"),{type:"bar",data:{labels:["Behavior Description","Reflection","Labeled Praise","Negative Talk","Question","Command","Neutral Talk","Unlabeled Praise"],datasets:[{label:"Fraction (%)",backgroundColor:["#3e95cd","#3e95cd","#3e95cd","#ed4337","#ed4337","#ed4337","#d3d3d3","#d3d3d3"],data:[0,0,0,0,0,0,0,0]}]},options:{legend:{display:!1},scales:{yAxes:[{ticks:{fontSize:20,suggestedMin:0}}],labelString:"DPICS counts"}}});case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this;return"ja"==this.state.lan?c.a.createElement("div",{className:"main"},c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-4"}),c.a.createElement("div",{className:"col-4"},c.a.createElement("h1",null,"DPICS\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u30c7\u30e2")),c.a.createElement("div",{className:"col-3"}),c.a.createElement("div",{className:"col-1"},c.a.createElement("div",{className:"dropdown"},c.a.createElement("button",{className:"btn btn-secondary dropdown-toggle",type:"button",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},"Language (\u8a00\u8a9e)"),c.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"dropdownMenuButton"},c.a.createElement("a",{className:"dropdown-item",onClick:this.handleEnglishClick()},"English"),c.a.createElement("a",{className:"dropdown-item",onClick:this.handleJapaneseClick()},"\u65e5\u672c\u4eba (Japanese)")))))),c.a.createElement("div",{className:"description"},"\u3053\u308c\u306f\u3001DPICS\u306b\u5f93\u3063\u3066\u89aa\u5b50\u76f8\u4e92\u4f5c\u7528\u3092\u30b3\u30fc\u30c9\u5316\u3057\u305f\u30c6\u30ad\u30b9\u30c8\u5206\u985e\u30e2\u30c7\u30eb\u306e\u30c7\u30e2\u3067\u3059\u3002\u4ee5\u4e0b\u306e\u30b5\u30f3\u30d7\u30eb\u306f\u3001\u30e2\u30c7\u30eb\u306e\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u51fa\u529b\u3092\u793a\u3057\u3066\u3044\u307e\u3059\u3002"),c.a.createElement("p",null,"\u4e0b\u306b\u65e5\u672c\u8a9e\u3067\u6587\u7ae0\u3092\u5165\u529b\u3057\u3001\u300c\u30b3\u30fc\u30c9\u300d\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066DPICS\u306b\u5f93\u3063\u3066\u30b3\u30fc\u30c9\u5316\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),c.a.createElement("div",null,c.a.createElement("input",{id:"classify-new-text-input",placeholder:"\u3059\u306a\u308f\u3061\u300c\u79c1\u3068\u904a\u307c\u3046\u300d"}),c.a.createElement("div",{id:"classify-new-text",onClick:this.classifyText()},"\u30b3\u30fc\u30c9")),c.a.createElement("div",{id:"table-wrapper"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"text"},"\u89aa\u306e\u6587"),c.a.createElement("div",{className:"label"},"\u52d5\u4f5c\u8aac\u660e"),c.a.createElement("div",{className:"label"},"\u30b3\u30de\u30f3\u30c9"),c.a.createElement("div",{className:"label"},"\u30e9\u30d9\u30eb\u4ed8\u304d\u306e\u8cde\u8cdb"),c.a.createElement("div",{className:"label"},"\u30cd\u30ac\u30c6\u30a3\u30d6\u30c8\u30fc\u30af"),c.a.createElement("div",{className:"label"},"\u30cb\u30e5\u30fc\u30c8\u30e9\u30eb\u30c8\u30fc\u30af"),c.a.createElement("div",{className:"label"},"\u8cea\u554f"),c.a.createElement("div",{className:"label"},"\u53cd\u5c04"),c.a.createElement("div",{className:"label"},"\u30e9\u30d9\u30eb\u306a\u3057\u79f0\u8cdb"),c.a.createElement("div",{className:"label"},"\u4e0d\u6b63\u306a\u30b3\u30fc\u30c9\uff1f")),this.state.sentences.map(function(a,t){return c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"text"},a.text),1==a.pred[0]?c.a.createElement("div",{className:"label positive"},"\u304a\u305d\u3089\u304f"):c.a.createElement("div",{className:"label"},"\u3042\u308a\u305d\u3046\u3082\u306a\u3044"),1==a.pred[1]?c.a.createElement("div",{className:"label positive"},"\u304a\u305d\u3089\u304f"):c.a.createElement("div",{className:"label"},"\u3042\u308a\u305d\u3046\u3082\u306a\u3044"),1==a.pred[2]?c.a.createElement("div",{className:"label positive"},"\u304a\u305d\u3089\u304f"):c.a.createElement("div",{className:"label"},"\u3042\u308a\u305d\u3046\u3082\u306a\u3044"),1==a.pred[3]?c.a.createElement("div",{className:"label positive"},"\u304a\u305d\u3089\u304f"):c.a.createElement("div",{className:"label"},"\u3042\u308a\u305d\u3046\u3082\u306a\u3044"),1==a.pred[4]?c.a.createElement("div",{className:"label positive"},"\u304a\u305d\u3089\u304f"):c.a.createElement("div",{className:"label"},"\u3042\u308a\u305d\u3046\u3082\u306a\u3044"),1==a.pred[5]?c.a.createElement("div",{className:"label positive"},"\u304a\u305d\u3089\u304f"):c.a.createElement("div",{className:"label"},"\u3042\u308a\u305d\u3046\u3082\u306a\u3044"),1==a.pred[6]?c.a.createElement("div",{className:"label positive"},"\u304a\u305d\u3089\u304f"):c.a.createElement("div",{className:"label"},"\u3042\u308a\u305d\u3046\u3082\u306a\u3044"),1==a.pred[7]?c.a.createElement("div",{className:"label positive"},"\u304a\u305d\u3089\u304f"):c.a.createElement("div",{className:"label"},"\u3042\u308a\u305d\u3046\u3082\u306a\u3044"),c.a.createElement("div",{className:"label"},c.a.createElement("div",{className:"flag-btn",onClick:e.uploadFlagToServer(a.text,a.proba,1,e)},"\u507d\u30b3\u30fc\u30c9")))})),c.a.createElement("h2",null,"\u95a2\u9023\u8ad6\u6587\u306fPervasiveHealth 2019\u306b\u63b2\u8f09\u3055\u308c\u3066\u3044\u307e\u3059\u3002"),c.a.createElement("p",null,"\u79c1\u305f\u3061\u306f\u89aa\u304c\u30b3\u30df\u30e5\u30cb\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u3068\u308b\u306e\u3092\u52a9\u3051\u308b\u305f\u3081\u306e\u30b7\u30b9\u30c6\u30e0\u3068\u3057\u3066\u3053\u306e\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u30c4\u30fc\u30eb\u3092\u7814\u7a76\u3057\u307e\u3057\u305f\u3002\u8a73\u7d30\u306b\u3064\u3044\u3066\u306f\u3001",c.a.createElement("a",{href:"https://scholar.harvard.edu/files/bhb/files/specialtime_final_pervasivehealth19.pdf"},"\u30db\u30ef\u30a4\u30c8\u30da\u30fc\u30d1\u30fc"),"\u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002"),c.a.createElement("p",null,"\u4f5c\u6210\u8005\uff1a",c.a.createElement("a",{href:"https://scholar.harvard.edu/bhb"}," Bernd Huber "))):c.a.createElement("div",{className:"main"},c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-4"}),c.a.createElement("div",{className:"col-4"},c.a.createElement("h1",null,"DPICS coding demo")),c.a.createElement("div",{className:"col-3"}),c.a.createElement("div",{className:"col-1"},c.a.createElement("div",{className:"dropdown"},c.a.createElement("button",{className:"btn btn-secondary dropdown-toggle",type:"button",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},"Language (\u8a00\u8a9e)"),c.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"dropdownMenuButton"},c.a.createElement("a",{className:"dropdown-item",onClick:this.handleEnglishClick()},"English"),c.a.createElement("a",{className:"dropdown-item",onClick:this.handleJapaneseClick()},"\u65e5\u672c\u4eba (Japanese)")))))),c.a.createElement("h2",null,"Demo 1 - Text coding:"),c.a.createElement("div",{className:"description"},"This is a demo of the text classification model that codes parent-child interaction according to the DPICS. The samples below illustrate the coding output of the model."),c.a.createElement("p",null,"Enter your sentence below and click 'Code' to code it according to the DPICS."),c.a.createElement("div",null,c.a.createElement("input",{id:"classify-new-text-input",placeholder:"i.e. 'Come play with me'"}),c.a.createElement("div",{id:"classify-new-text",onClick:this.classifyText()},"Code")),c.a.createElement("div",{id:"table-wrapper"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"text"},"Parent Sentence"),c.a.createElement("div",{className:"label"},"Behavior Description"),c.a.createElement("div",{className:"label"},"Command"),c.a.createElement("div",{className:"label"},"Labeled Praise"),c.a.createElement("div",{className:"label"},"Negative Talk"),c.a.createElement("div",{className:"label"},"Neutral Talk"),c.a.createElement("div",{className:"label"},"Question"),c.a.createElement("div",{className:"label"},"Reflection"),c.a.createElement("div",{className:"label"},"Unlabeled Praise"),c.a.createElement("div",{className:"label"},"Wrong code?")),this.state.sentences.map(function(a,t){return c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"text"},a.text),1==a.pred[0]?c.a.createElement("div",{className:"label positive"},"Likely"):c.a.createElement("div",{className:"label"},"Unlikely"),1==a.pred[1]?c.a.createElement("div",{className:"label positive"},"Likely"):c.a.createElement("div",{className:"label"},"Unlikely"),1==a.pred[2]?c.a.createElement("div",{className:"label positive"},"Likely"):c.a.createElement("div",{className:"label"},"Unlikely"),1==a.pred[3]?c.a.createElement("div",{className:"label positive"},"Likely"):c.a.createElement("div",{className:"label"},"Unlikely"),1==a.pred[4]?c.a.createElement("div",{className:"label positive"},"Likely"):c.a.createElement("div",{className:"label"},"Unlikely"),1==a.pred[5]?c.a.createElement("div",{className:"label positive"},"Likely"):c.a.createElement("div",{className:"label"},"Unlikely"),1==a.pred[6]?c.a.createElement("div",{className:"label positive"},"Likely"):c.a.createElement("div",{className:"label"},"Unlikely"),1==a.pred[7]?c.a.createElement("div",{className:"label positive"},"Likely"):c.a.createElement("div",{className:"label"},"Unlikely"),c.a.createElement("div",{className:"label"},c.a.createElement("div",{className:"flag-btn",onClick:e.uploadFlagToServer(a.text,a.proba,1,e)},"Flag this")))})),c.a.createElement("h2",null,"Demo 2 - Speech coding (experimental):"),c.a.createElement("div",{className:"description"},"This is a demo of the speech classification model that codes ",c.a.createElement("b",null,"spoken")," parent-child interaction according to the DPICS. Make sure to use ",c.a.createElement("a",{href:"https://www.google.com/chrome/browser/"},"Google Chrome")," on Desktop or Android for this demo to work."),c.a.createElement("p",null,"Click 'Start' when you start interacting with your child, 'Stop' when the interaction has ended, and 'Reset' to reset the demo."),c.a.createElement("div",{className:"wrapper2"},c.a.createElement("div",{className:"start-meeting",onClick:function(){N.start(),f=1}},"Start"),c.a.createElement("div",{className:"start-meeting",onClick:function(){N.stop(),f=0}},"Stop"),c.a.createElement("div",{className:"start-meeting",onClick:function(){g=[0,0,0,0,0,0,0,0],"",w()}},"Reset")),c.a.createElement("div",null,"DPICS counts:"),c.a.createElement("div",{style:{width:"50%",height:"450px"}},c.a.createElement("canvas",{id:"bar-chart",width:"200",height:"150"})),c.a.createElement("h2",null,"The related paper is published at PervasiveHealth 2019:"),c.a.createElement("p",null,"We studied this coding tool as a system to help parents communicate. Make sure to check out our ",c.a.createElement("a",{href:"https://scholar.harvard.edu/files/bhb/files/specialtime_final_pervasivehealth19.pdf"},"paper")," for more details."),c.a.createElement("p",null,"Created by: ",c.a.createElement("a",{href:"https://scholar.harvard.edu/bhb"},"Bernd Huber")))}}]),a}(s.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(c.a.createElement(k,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[11,1,2]]]);
//# sourceMappingURL=main.218edff7.chunk.js.map