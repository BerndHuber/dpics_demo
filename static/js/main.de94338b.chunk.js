(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{11:function(e,t,a){e.exports=a(21)},17:function(e,t,a){},19:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},20:function(e,t,a){},21:function(e,t,a){"use strict";a.r(t);var l,n,s=a(0),o=a.n(s),i=a(4),c=a.n(i),r=(a(17),a(2)),d=a.n(r),m=a(5),u=a(6),p=a(7),h=a(9),v=a(8),b=a(1),g=a(10),f=(a(19),a(20),new(0,window.webkitSpeechRecognition)),E=[0,0,0,0,0,0,0,0],w=0;function y(){n.data.datasets[0].data=E,n.update()}function k(e,t){var a="https://script.google.com/macros/s/AKfycbwK3EEp-8NU7wLEXLrZesp7XcjUYh7H6zdgQj7vBfDpDlwa13gl/exec?";a+="timest="+(new Date).getTime(),a+="&sentence="+e,a+="&bd="+t[0],a+="&cmd="+t[1],a+="&lp="+t[2],a+="&nt="+t[3],a+="&neutral="+t[4],a+="&qu="+t[5],a+="&rf="+t[6],a+="&up="+t[7],console.log("uploading data"),fetch(a).then(function(e){return e.text()}).then(function(e){console.log("response: "),console.log(e)}).catch(function(e){console.log(e)})}f.continuous=!0,f.onresult=function(e){var t=e.resultIndex,a=e.results[t][0].transcript;";"+a;var n;n=a,l.classify([n]).then(function(e){for(var t=0,a=1,l=[],s=0;s<8;s++)e[s].results[0].probabilities[0]<a&&(t=s,a=e[s].results[0].probabilities[0]),console.log(e[s].results[0].probabilities[0]),l.push(e[s].results[0].probabilities[0]);console.log("--");var o=[0,5,2,3,6,4,1,7][t];return E[o]+=1,k("speech:"+n,l),y(),!0})},f.onstart=function(){console.log("Voice recognition is ON.")},f.onspeechend=function(){console.log("No activity."),f.stop(),1==w&&setTimeout(function(){f.start(),console.log("speech started")},500)},f.onerror=function(e){"no-speech"==e.error&&(console.log("Try again."),f.stop(),1==w&&setTimeout(function(){f.start(),console.log("speech started")},500))};var N=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(h.a)(this,Object(v.a)(t).call(this,e))).uploadFlagToServer=function(e,t,a,l){return function(n){if(console.log("uploadFlagToServer"),1!=a||!l.state.flagged_sentences.includes(e)){var s=l.state.flagged_sentences;s.push(e),l.setState({flagged_sentences:s});var o="https://script.google.com/macros/s/AKfycbwK3EEp-8NU7wLEXLrZesp7XcjUYh7H6zdgQj7vBfDpDlwa13gl/exec?";o+="timest="+(new Date).getTime(),o+="&sentence="+e,o+="&bd="+t[0],o+="&cmd="+t[1],o+="&lp="+t[2],o+="&nt="+t[3],o+="&neutral="+t[4],o+="&qu="+t[5],o+="&rf="+t[6],o+="&up="+t[7],o+="&flagged="+a,console.log("uploading data"),fetch(o).then(function(e){return e.text()}).then(function(e){console.log("response: "),console.log(e)}).catch(function(e){console.log(e)})}}},a.classifyText=function(){return function(e){var t=Object(b.a)(a);console.log(document.getElementById("classify-new-text-input").value);var n=document.getElementById("classify-new-text-input").value;l.classify([n]).then(function(e){console.log(e);for(var a=[],l=[],s=0,o=1,i=0;i<8;i++)e[i].results[0].probabilities[0]<o&&(s=i,o=e[i].results[0].probabilities[0]),console.log(e[i].results[0].probabilities[0]),e[i].results[0].probabilities[0]>.9?a.push(1):a.push(0),l.push(e[i].results[0].probabilities[0]);(a=[0,0,0,0,0,0,0,0])[s]=1,k(n,l),console.log(a);var c=t.state.sentences;return c.unshift({text:n,pred:a,proba:l}),t.setState({sentence:c}),!0})}},a.state={participantid:Date.now(),sentences:[{text:"What are you doing?",pred:[0,0,0,0,0,1,0,0],proba:[1,1,1,1,1,0,1,1]}],flagged_sentences:[]},a}return Object(g.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=Object(m.a)(d.a.mark(function e(){var t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:.7,t=["unlabelled_praise","command","neutral_talk","labelled_praise","question","behavior_description","reflection","negative_talk"],window.toxicity.load(.7,t).then(function(e){l=e}),n=new window.Chart(document.getElementById("bar-chart"),{type:"bar",data:{labels:["Behavior Description","Reflection","Labeled Praise","Negative Talk","Question","Command","Neutral Talk","Unlabeled Praise"],datasets:[{label:"Fraction (%)",backgroundColor:["#3e95cd","#3e95cd","#3e95cd","#ed4337","#ed4337","#ed4337","#d3d3d3","#d3d3d3"],data:[0,0,0,0,0,0,0,0]}]},options:{legend:{display:!1},scales:{yAxes:[{ticks:{fontSize:20,suggestedMin:0}}],labelString:"DPICS counts"}}});case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"main"},o.a.createElement("h1",null,"DPICS coding demo"),o.a.createElement("h2",null,"Demo 1 - Text coding:"),o.a.createElement("div",{className:"description"},"This is a demo of the text classification model that codes parent-child interaction according to the DPICS. The samples below illustrate the coding output of the model."),o.a.createElement("p",null,"Enter your sentence below and click 'Code' to code it according to the DPICS."),o.a.createElement("div",null,o.a.createElement("input",{id:"classify-new-text-input",placeholder:"i.e. 'Come play with me'"}),o.a.createElement("div",{id:"classify-new-text",onClick:this.classifyText()},"Code")),o.a.createElement("div",{id:"table-wrapper"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"text"},"Parent Sentence"),o.a.createElement("div",{className:"label"},"Behavior Description"),o.a.createElement("div",{className:"label"},"Command"),o.a.createElement("div",{className:"label"},"Labeled Praise"),o.a.createElement("div",{className:"label"},"Negative Talk"),o.a.createElement("div",{className:"label"},"Neutral Talk"),o.a.createElement("div",{className:"label"},"Question"),o.a.createElement("div",{className:"label"},"Reflection"),o.a.createElement("div",{className:"label"},"Unlabeled Praise"),o.a.createElement("div",{className:"label"},"Wrong code?")),this.state.sentences.map(function(t,a){return o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"text"},t.text),1==t.pred[0]?o.a.createElement("div",{className:"label positive"},"Likely"):o.a.createElement("div",{className:"label"},"Unlikely"),1==t.pred[1]?o.a.createElement("div",{className:"label positive"},"Likely"):o.a.createElement("div",{className:"label"},"Unlikely"),1==t.pred[2]?o.a.createElement("div",{className:"label positive"},"Likely"):o.a.createElement("div",{className:"label"},"Unlikely"),1==t.pred[3]?o.a.createElement("div",{className:"label positive"},"Likely"):o.a.createElement("div",{className:"label"},"Unlikely"),1==t.pred[4]?o.a.createElement("div",{className:"label positive"},"Likely"):o.a.createElement("div",{className:"label"},"Unlikely"),1==t.pred[5]?o.a.createElement("div",{className:"label positive"},"Likely"):o.a.createElement("div",{className:"label"},"Unlikely"),1==t.pred[6]?o.a.createElement("div",{className:"label positive"},"Likely"):o.a.createElement("div",{className:"label"},"Unlikely"),1==t.pred[7]?o.a.createElement("div",{className:"label positive"},"Likely"):o.a.createElement("div",{className:"label"},"Unlikely"),o.a.createElement("div",{className:"label"},o.a.createElement("div",{className:"flag-btn",onClick:e.uploadFlagToServer(t.text,t.proba,1,e)},"Flag this")))})),o.a.createElement("h2",null,"Demo 2 - Speech coding (experimental):"),o.a.createElement("div",{className:"description"},"This is a demo of the speech classification model that codes ",o.a.createElement("b",null,"spoken")," parent-child interaction according to the DPICS. Make sure to use ",o.a.createElement("a",{href:"https://www.google.com/chrome/browser/"},"Google Chrome")," on Desktop or Android for this demo to work."),o.a.createElement("p",null,"Click 'Start' when you start interacting with your child, 'Stop' when the interaction has ended, and 'Reset' to reset the demo."),o.a.createElement("div",{className:"wrapper2"},o.a.createElement("div",{className:"start-meeting",onClick:function(){f.start(),w=1}},"Start"),o.a.createElement("div",{className:"start-meeting",onClick:function(){f.stop(),w=0}},"Stop"),o.a.createElement("div",{className:"start-meeting",onClick:function(){E=[0,0,0,0,0,0,0,0],"",y()}},"Reset")),o.a.createElement("div",null,"DPICS counts:"),o.a.createElement("div",{style:{width:"50%",height:"450px"}},o.a.createElement("canvas",{id:"bar-chart",width:"200",height:"150"})),o.a.createElement("h2",null,"The related paper is published at PervasiveHealth 2019:"),o.a.createElement("p",null,"We studied this coding tool as a system to help parents communicate. Make sure to check out our ",o.a.createElement("a",{href:"https://scholar.harvard.edu/files/bhb/files/specialtime_final_pervasivehealth19.pdf"},"paper")," for more details."),o.a.createElement("p",null,"Created by: ",o.a.createElement("a",{href:"https://scholar.harvard.edu/bhb"},"Bernd Huber")))}}]),t}(s.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(N,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[11,1,2]]]);
//# sourceMappingURL=main.de94338b.chunk.js.map